# Analytics Dashboard - Аналитическая панель

## Описание

Полнофункциональный dashboard для просмотра метрик и аналитики по выполненным задачам, заказам и производственным продуктам с возможностью фильтрации по временным периодам и визуализации данных в виде графиков.

## Функции

### 1. Фильтры по времени
- **День** - показывает метрики за текущий день
- **Неделя** - показывает метрики за текущую неделю
- **Месяц** - показывает метрики за текущий месяц
- **Год** - показывает метрики за текущий год

### 2. Метрики по задачам (Tasks)
- Общее количество задач
- Выполненные задачи
- Задачи в процессе
- Просроченные задачи
- Процент выполнения
- Среднее время выполнения (в часах)
- График трендов выполнения задач

### 3. Метрики по заказам (Orders)
- Общее количество заказов
- Выполненные заказы
- Заказы в обработке
- Ожидающие заказы
- Общая выручка
- Средний чек
- График трендов заказов (Bar Chart)

### 4. Метрики по продуктам (Products)
- Общее количество продуктов
- Активные продукты
- Продукты с низким запасом
- Продукты вне наличия
- График производственных трендов

## Структура проекта

### Модели данных
- `lib/models/dashboard_metrics.dart` - модели для метрик и данных dashboard

### Сервисы
- `lib/services/dashboard_service.dart` - сервис для получения данных метрик с API

### Экраны
- `lib/screens/analytics/analytics_dashboard_screen.dart` - основной экран аналитики

## Навигация

Dashboard доступен через боковое меню приложения (App Drawer):
1. Откройте боковое меню
2. Выберите пункт "Analytics"
3. Вы попадете на экран с метриками и графиками

## API Integration

Сервис `DashboardService` пытается получить данные из следующих эндпоинтов:
- `/production/tasks/metrics` - метрики по задачам
- `/production/tasks/trend` - тренды задач
- `/orders/metrics` - метрики по заказам
- `/orders/trend` - тренды заказов
- `/products/metrics` - метрики по продуктам
- `/products/production-trend` - производственные тренды

### Fallback механизм
Если API эндпоинты не доступны, сервис автоматически вычисляет метрики на основе существующих данных:
- Для задач - использует `/production/tasks`
- Для заказов - использует `/orders`
- Для продуктов - использует `/products`

## Визуализация данных

### Графики (fl_chart)
1. **Line Chart** - для трендов задач и производства
   - Плавные кривые
   - Точки данных (для малых наборов)
   - Заливка под графиком

2. **Bar Chart** - для трендов заказов
   - Вертикальные столбцы
   - Интерактивное взаимодействие

### Карточки метрик
- Иконки с градиентными фонами
- Цветовая индикация статуса
- Процентные показатели
- Статистические данные

## Цветовая схема

- **Primary (Indigo)** - основные элементы, задачи в процессе
- **Success (Green)** - выполненные задачи, активные продукты
- **Error (Red)** - просроченные задачи, продукты вне наличия
- **Warning (Orange)** - низкий запас, ожидающие заказы
- **Info (Cyan)** - информационные метрики

## Требования

- Flutter SDK: ^3.8.0
- Dart: ^3.8.0
- Зависимости:
  - `fl_chart: ^0.66.0` - для графиков
  - `intl: ^0.20.2` - для форматирования дат

## Использование

```dart
// Навигация к dashboard
Navigator.pushNamed(context, '/analytics');

// Или через сервис
import 'package:SymphonyERP/screens/analytics/analytics_dashboard_screen.dart';

Navigator.push(
  context,
  MaterialPageRoute(
    builder: (context) => const AnalyticsDashboardScreen(),
  ),
);
```

## Кастомизация

### Добавление новых метрик
1. Обновите модель `DashboardMetrics` в `dashboard_metrics.dart`
2. Добавьте логику получения данных в `DashboardService`
3. Создайте виджет для отображения в `analytics_dashboard_screen.dart`

### Изменение периодов
Enum `DatePeriod` можно расширить дополнительными периодами:
```dart
enum DatePeriod { day, week, month, quarter, year, custom }
```

## Производительность

- Данные кэшируются при смене фильтров
- Параллельная загрузка метрик с помощью `Future.wait`
- Ленивая загрузка графиков
- Pull-to-refresh для обновления данных

## Будущие улучшения

- [ ] Экспорт данных в PDF/Excel
- [ ] Кастомные диапазоны дат
- [ ] Сравнение периодов
- [ ] Детализация по категориям
- [ ] Push-уведомления о важных метриках
- [ ] Офлайн режим с синхронизацией

## Поддержка

Для вопросов и предложений обращайтесь к команде разработки.
